## e-Claim Referent DBF File Structure & Data Dictionary
เวอร์ชันอ้างอิง: TH005P013 (เอกสารประกอบการพัฒนา API SPEC สำหรับผู้พัฒนา — โครงสร้างชุดข้อมูลเพื่อการเรียกเก็บค่าใช้จ่ายเพื่อบริการสาธารณสุข e-Claim)
ผู้จัดทำไฟล์สรุป: ทีมพัฒนา (Internal)
Encoding แนะนำ: TIS-620 หรือ UTF-8 (ขึ้นกับข้อกำหนดระบบส่งข้อมูล)

### 1) DATA SET SUMMARY (สรุปชุดข้อมูลและความสัมพันธ์)
- ภาพรวม 16 แฟ้มมาตรฐาน:
  - INS: สิทธิการรักษา
  - PAT: ผู้ป่วยกลาง
  - OPD: การมารับบริการผู้ป่วยนอก
  - ORF: การส่งต่อผู้ป่วยนอก
  - ODX: วินิจฉัย OPD (ICD-10)
  - OOP: หัตถการ OPD (ICD-9/หัตถการ)
  - IPD: ผู้ป่วยใน
  - IRF: การส่งต่อผู้ป่วยใน
  - IDX: วินิจฉัย IPD (ICD-10)
  - IOP: หัตถการ IPD (ICD-9/หัตถการ)
  - CHT: การเงินแบบสรุป (Claim/Charge Summary)
  - CHA: การเงินแบบรายละเอียด (Claim/Charge Detail)
  - AER: อุบัติเหตุ/ฉุกเฉิน/รับส่งเพื่อรักษา
  - ADP: ค่าใช้จ่ายเพิ่มเติม/นอกหมวด
  - LVD: วันลากลับบ้าน (Leave Day)
  - DRU: การใช้ยา

- คีย์กลาง/ความสัมพันธ์สำคัญ:
  - หน่วยบริการ: HCODE (ทุกแฟ้ม)
  - ระดับบุคคล: PID (INS/PAT) และ/หรือ CID, HN (ในบริบทหน่วยบริการ)
  - ระดับเหตุการณ์บริการ OPD: SEQ ร่วมกับ HCODE, HN, DATEOPD
  - ระดับผู้ป่วยใน IPD: AN ร่วมกับ HCODE
  - การอ้างอิงข้ามแฟ้ม:
    - OPD → ODX/OOP/ORF/AER/CHA/ADP/DRU: ผ่าน (HCODE, HN, DATEOPD, SEQ)
    - IPD → IDX/IOP/IRF/LVD/AER/CHA/ADP/DRU/CHT: ผ่าน (HCODE, AN)
    - CHT/CHA: อาจอ้างอิง AN หรือ SEQ/BILLNO/CLAIMNO ตามบริบทการคิดเงิน
    - INS/PAT: ให้ข้อมูลสิทธิและข้อมูลประจำตัว ใช้เชื่อมกับ OPD/IPD ทาง HN/CID/PID

- ความถี่และรูปแบบส่ง:
  - รายวัน/รายเคส ตามช่วงเวลาส่งเคลมของหน่วยบริการ
  - ไฟล์แยกตามแฟ้มมาตรฐาน (นามสกุล .dbf แนะนำ) หรือเทียบเท่าตาม Spec ที่รองรับ

---

### 2) DATA SET COLUMN (รายละเอียดคอลัมน์ของแต่ละแฟ้ม)
หมายเหตุ: Type/Length เป็นแนวทางสำหรับ DBF (C=Character, N=Numeric, D=Date, L=Logical, F=Float, M=Memo)

#### 2.1 INS — สิทธิการรักษา
| Field | Type | Length | Required | Description | Example |
|------|------|--------|----------|-------------|---------|
| HCODE | C | 5 | Y | รหัสหน่วยบริการ | 11001 |
| PID | C | 15 | Y | รหัสบุคคลในชุดข้อมูล | 000123456789000 |
| HN | C | 15 | N | เลขผู้ป่วยหน่วยบริการ | 123456 |
| CID | C | 13 | N | เลขบัตรประชาชน | 11017000xxxxx |
| INSCL | C | 2 | Y | รหัสสิทธิ์ | UC |
| SUBTYPE | C | 2 | N | ประเภทย่อยสิทธิ์ | 01 |
| DATEIN | D | 8 | Y | วันที่เริ่มสิทธิ์ (YYYYMMDD) | 20240101 |
| DATEEXP | D | 8 | N | วันที่สิ้นสุดสิทธิ์ | 20241231 |
| HMAIN | C | 5 | N | หน่วยบริการหลัก | 12345 |
| HSUB | C | 5 | N | หน่วยบริการรอง | 67890 |

#### 2.2 PAT — ผู้ป่วยกลาง
| Field | Type | Length | Required | Description | Example |
|------|------|--------|----------|-------------|---------|
| HCODE | C | 5 | Y | รหัสหน่วยบริการ | 11001 |
| PID | C | 15 | Y | รหัสบุคคลในชุดข้อมูล | 000123456789000 |
| HN | C | 15 | Y | เลขผู้ป่วยหน่วยบริการ | 123456 |
| CID | C | 13 | N | เลขบัตรประชาชน | 11017000xxxxx |
| TITLE | C | 10 | N | คำนำหน้า | นาย |
| NAME | C | 50 | Y | ชื่อ | สมชาย |
| LNAME | C | 50 | Y | นามสกุล | ใจดี |
| DOB | D | 8 | Y | วันเกิด | 19900115 |
| SEX | C | 1 | Y | 1=ชาย,2=หญิง ฯลฯ | 1 |
| NATION | C | 3 | N | สัญชาติ | THA |
| OCCUPA | C | 3 | N | อาชีพ (รหัส) | 001 |
| MARRIAGE | C | 1 | N | สถานะสมรส | 1 |

#### 2.3 OPD — ผู้ป่วยนอก
| Field | Type | Length | Req | Description | Example |
|------|------|--------|-----|-------------|---------|
| HCODE | C | 5 | Y | รหัสหน่วยบริการ | 11001 |
| HN | C | 15 | Y | เลขผู้ป่วย | 123456 |
| DATEOPD | D | 8 | Y | วันที่รับบริการ | 20240131 |
| TIMEOPD | C | 6 | N | เวลา HHMMSS | 093015 |
| SEQ | C | 20 | Y | เลขลำดับเหตุการณ์ | 20240131-001 |
| CLINIC | C | 5 | N | รหัสคลินิก | 001 |
| UUC | C | 1 | N | สถานะ UUC | 1 |

#### 2.4 ORF — ส่งต่อ OPD
| Field | Type | Length | Req | Description | Example |
|------|------|--------|-----|-------------|---------|
| HCODE | C | 5 | Y | รหัสหน่วยบริการ | 11001 |
| HN | C | 15 | Y | เลขผู้ป่วย | 123456 |
| DATEOPD | D | 8 | Y | วันที่รับบริการ | 20240131 |
| SEQ | C | 20 | Y | อ้างอิง OPD | 20240131-001 |
| REFER | C | 5 | Y | รพ.ปลายทาง | 12345 |
| REFERTYPE | C | 1 | N | ประเภทส่งต่อ | 1 |
| REFERDATE | D | 8 | N | วันที่ส่งต่อ | 20240201 |

#### 2.5 ODX — วินิจฉัย OPD
| Field | Type | Length | Req | Description | Example |
|------|------|--------|-----|-------------|---------|
| HCODE | C | 5 | Y | รหัสหน่วยบริการ | 11001 |
| HN | C | 15 | Y | เลขผู้ป่วย | 123456 |
| DATEOPD | D | 8 | Y | วันที่รับบริการ | 20240131 |
| SEQ | C | 20 | Y | อ้างอิง OPD | 20240131-001 |
| DIAG | C | 7 | Y | รหัส ICD-10 | J06.9 |
| DXTYPE | C | 1 | Y | P/S/O ฯลฯ | P |
| DRDX | C | 10 | N | รหัสแพทย์วินิจฉัย | DR001 |

#### 2.6 OOP — หัตถการ OPD
| Field | Type | Length | Req | Description | Example |
|------|------|--------|-----|-------------|---------|
| HCODE | C | 5 | Y | รหัสหน่วยบริการ | 11001 |
| HN | C | 15 | Y | เลขผู้ป่วย | 123456 |
| DATEOPD | D | 8 | Y | วันที่รับบริการ | 20240131 |
| SEQ | C | 20 | Y | อ้างอิง OPD | 20240131-001 |
| OPER | C | 7 | Y | ICD-9/หัตถการ | 99.29 |
| OPTYPE | C | 1 | N | ประเภทหัตถการ | 1 |
| DROPID | C | 10 | N | แพทย์ผู้ทำ | DR001 |

#### 2.7 IPD — ผู้ป่วยใน
| Field | Type | Length | Req | Description | Example |
|------|------|--------|-----|-------------|---------|
| HCODE | C | 5 | Y | รหัสหน่วยบริการ | 11001 |
| AN | C | 12 | Y | เลข Admit | 650012345678 |
| HN | C | 15 | Y | เลขผู้ป่วย | 123456 |
| DATEADM | D | 8 | Y | วันที่ Admit | 20240201 |
| TIMEADM | C | 6 | N | เวลา Admit | 084500 |
| DATEDSC | D | 8 | N | วันที่จำหน่าย | 20240204 |
| TIMEDSC | C | 6 | N | เวลาจำหน่าย | 101000 |
| DISCHS | C | 1 | N | สถานะจำหน่าย | 1 |
| DISCHT | C | 1 | N | ประเภทจำหน่าย | 1 |
| WARDDSC | C | 3 | N | วอร์ดที่จำหน่าย | 101 |
| UUC | C | 1 | N | สถานะ UUC | 1 |

#### 2.8 IRF — ส่งต่อ IPD
| Field | Type | Length | Req | Description | Example |
|------|------|--------|-----|-------------|---------|
| HCODE | C | 5 | Y | รหัสหน่วยบริการ | 11001 |
| AN | C | 12 | Y | อ้างอิง IPD | 650012345678 |
| REFER | C | 5 | Y | รพ.ปลายทาง | 12345 |
| REFERTYPE | C | 1 | N | ประเภทส่งต่อ | 1 |
| REFERDATE | D | 8 | N | วันที่ส่งต่อ | 20240202 |

#### 2.9 IDX — วินิจฉัย IPD
| Field | Type | Length | Req | Description | Example |
|------|------|--------|-----|-------------|---------|
| HCODE | C | 5 | Y | รหัสหน่วยบริการ | 11001 |
| AN | C | 12 | Y | อ้างอิง IPD | 650012345678 |
| DIAG | C | 7 | Y | ICD-10 | J18.9 |
| DXTYPE | C | 1 | Y | P/S/O ฯลฯ | P |
| DRDX | C | 10 | N | รหัสแพทย์วินิจฉัย | DR001 |

#### 2.10 IOP — หัตถการ IPD
| Field | Type | Length | Req | Description | Example |
|------|------|--------|-----|-------------|---------|
| HCODE | C | 5 | Y | รหัสหน่วยบริการ | 11001 |
| AN | C | 12 | Y | อ้างอิง IPD | 650012345678 |
| OPER | C | 7 | Y | ICD-9/หัตถการ | 99.29 |
| OPTYPE | C | 1 | N | ประเภทหัตถการ | 1 |
| DROPID | C | 10 | N | แพทย์ผู้ทำ | DR001 |

#### 2.11 CHT — การเงินแบบสรุป
| Field | Type | Length | Req | Description | Example |
|------|------|--------|-----|-------------|---------|
| HCODE | C | 5 | Y | รหัสหน่วยบริการ | 11001 |
| AN | C | 12 | N | อ้างอิง IPD (ถ้าเป็นเคส IPD) | 650012345678 |
| SEQ | C | 20 | N | อ้างอิง OPD (ถ้าเป็นเคส OPD) | 20240131-001 |
| CLAIMNO | C | 30 | Y | เลขที่เคลม/ใบแจ้งหนี้ | CLM-2024-00001 |
| CHARGETYPE | C | 3 | N | ประเภทค่าใช้จ่ายรวม | SUM |
| AMOUNT | N | 13,2 | Y | จำนวนเงินรวม | 1500.00 |
| PAYPLAN | C | 5 | N | แผนการชำระ/กองทุน | UC |

#### 2.12 CHA — การเงินแบบรายละเอียด
| Field | Type | Length | Req | Description | Example |
|------|------|--------|-----|-------------|---------|
| HCODE | C | 5 | Y | รหัสหน่วยบริการ | 11001 |
| CLAIMNO | C | 30 | Y | อ้างอิง CHT | CLM-2024-00001 |
| AN | C | 12 | N | อ้างอิง IPD (ถ้ามี) | 650012345678 |
| SEQ | C | 20 | N | อ้างอิง OPD (ถ้ามี) | 20240131-001 |
| CHRGITEM | C | 20 | Y | หมวดรายการค่าใช้จ่าย | LAB |
| ITEMCODE | C | 24 | N | รหัสรายการ | L001 |
| QTY | N | 9,2 | Y | ปริมาณ | 1.00 |
| RATE | N | 13,2 | Y | ราคาต่อหน่วย | 500.00 |
| AMOUNT | N | 13,2 | Y | จำนวนเงินรวม | 500.00 |
| PAYRATE | N | 13,2 | N | อัตราที่จ่าย | 500.00 |

#### 2.13 AER — อุบัติเหตุ/ฉุกเฉิน/รับส่งเพื่อรักษา
| Field | Type | Length | Req | Description | Example |
|------|------|--------|-----|-------------|---------|
| HCODE | C | 5 | Y | รหัสหน่วยบริการ | 11001 |
| AN | C | 12 | N | อ้างอิง IPD | 650012345678 |
| HN | C | 15 | N | อ้างอิง HN | 123456 |
| DATEOPD | D | 8 | N | วันที่บริการ OPD | 20240131 |
| SEQ | C | 20 | N | อ้างอิง OPD | 20240131-001 |
| AETYPE | C | 1 | N | ประเภทอุบัติเหตุ | 1 |
| AEDATE | D | 8 | N | วันที่เกิดเหตุ | 20240131 |
| AETIME | C | 6 | N | เวลาเกิดเหตุ | 091500 |
| AEPLACE | C | 2 | N | สถานที่เกิดเหตุ | 01 |
| REFER | C | 5 | N | หน่วยบริการอ้าง/ปลายทาง | 12345 |

#### 2.14 ADP — ค่าใช้จ่ายเพิ่ม/บริการนอกหมวด
| Field | Type | Length | Req | Description | Example |
|------|------|--------|-----|-------------|---------|
| HCODE | C | 5 | Y | รหัสหน่วยบริการ | 11001 |
| AN | C | 12 | N | อ้างอิง IPD | 650012345678 |
| SEQ | C | 20 | N | อ้างอิง OPD | 20240131-001 |
| CODE | C | 20 | Y | รหัสรายการ | SUPP001 |
| QTY | N | 9,2 | Y | ปริมาณ | 1.00 |
| RATE | N | 13,2 | Y | ราคาต่อหน่วย | 250.00 |
| TOTAL | N | 13,2 | Y | จำนวนเงินรวม | 250.00 |

#### 2.15 LVD — วันลากลับบ้าน
| Field | Type | Length | Req | Description | Example |
|------|------|--------|-----|-------------|---------|
| HCODE | C | 5 | Y | รหัสหน่วยบริการ | 11001 |
| AN | C | 12 | Y | อ้างอิง IPD | 650012345678 |
| LDATE | D | 8 | Y | วันที่ลาออกชั่วคราว | 20240203 |
| LTIME | C | 6 | N | เวลาออก | 100000 |
| RTNDATE | D | 8 | N | วันที่กลับ | 20240203 |
| RTNTIME | C | 6 | N | เวลากลับ | 160000 |

#### 2.16 DRU — การใช้ยา
| Field | Type | Length | Req | Description | Example |
|------|------|--------|-----|-------------|---------|
| HCODE | C | 5 | Y | รหัสหน่วยบริการ | 11001 |
| AN | C | 12 | N | อ้างอิง IPD | 650012345678 |
| HN | C | 15 | N | อ้างอิง HN | 123456 |
| DATEOPD | D | 8 | N | วันที่บริการ OPD | 20240131 |
| SEQ | C | 20 | N | อ้างอิง OPD | 20240131-001 |
| DIDSTD | C | 24 | Y | รหัสมาตรฐานยา (เช่น TMT) | TMT123456 |
| DRUGNAME | C | 100 | N | ชื่อยา | Paracetamol |
| QTY | N | 9,2 | Y | ปริมาณใช้ | 10.00 |
| UNIT | C | 10 | N | หน่วย | tab |
| DRUGPRIC | N | 13,2 | N | ราคาต่อหน่วย | 1.50 |
| DRUGCOST | N | 13,2 | N | ต้นทุนต่อหน่วย | 1.20 |
| DDATE | D | 8 | N | วันที่จ่ายยา | 20240131 |
| DTIME | C | 6 | N | เวลาจ่ายยา | 094500 |
| SIGCODE | C | 20 | N | รหัสวิธีใช้ | 1x3 pc |
| SIGTEXT | C | 100 | N | ข้อความวิธีใช้ | รับประทานหลังอาหาร 3 เวลา |

---

### 3) ข้อ 5 รายละเอียดแฟ้มมาตรฐานในการนำเข้าข้อมูล
- รูปแบบแฟ้ม:
  - รองรับ DBF ตามสเปค สปสช. (แนะนำ DBF encoding TIS-620; หากใช้ UTF-8 ให้แน่ใจว่าระบบปลายทางรองรับ)
  - 1 แฟ้มต่อ 1 ประเภทข้อมูล (INS, PAT, …, DRU)
- การตั้งชื่อแฟ้ม:
  - ใช้ชื่อแฟ้มตามรหัสชุดข้อมูล: INS.DBF, PAT.DBF, …, DRU.DBF
  - สามารถเติม prefix/suffix รอบส่ง/ปีเดือน ตามแนวปฏิบัติหน่วยบริการได้ หากระบบรับข้อมูลรองรับ
- รูปแบบข้อมูลคอลัมน์:
  - Character (C): padding ช่องว่างด้านขวาตามความยาวคอลัมน์
  - Numeric (N/F): จัดเก็บเป็นตัวเลข ไม่ใส่ comma; ทศนิยมตามสเปคคอลัมน์
  - Date (D): YYYYMMDD (เช่น 20240229); เวลา (ถ้ามี) เป็น HHMMSS โดยไม่คั่น
  - Logical (L): T/F (ถ้าระบุ)
- การตรวจสอบและข้อกำหนด:
  - Required=Y ต้องมีค่าและอยู่ในรูปแบบที่กำหนด
  - คีย์อ้างอิงข้ามแฟ้มต้องมีอยู่จริง:
    - OPD: (HCODE, HN, DATEOPD, SEQ) ต้อง match ระหว่าง OPD ↔ ODX/OOP/ORF/AER/CHA/ADP/DRU
    - IPD: (HCODE, AN) ต้อง match ระหว่าง IPD ↔ IDX/IOP/IRF/LVD/AER/CHA/ADP/DRU/CHT
  - ICD/Procedure/Drug ต้องอ้างอิงรหัสมาตรฐานล่าสุด (ICD-10, ICD-9-CM, TMT ฯลฯ)
  - จำนวนเงิน (CHA/CHT/ADP/DRU) ต้องไม่ติดลบ และสอดคล้อง QTY×RATE≈AMOUNT ภายใน tolerance ตามสเปค
- หลักเกณฑ์การส่งข้อมูล:
  - ส่งตามรอบเวลาที่กำหนด (รายวัน/รายสัปดาห์/รอบเคลม) พร้อมชุดแฟ้มที่เกี่ยวข้องครบถ้วน
  - การส่งข้อมูลทับ (resubmit) ให้ใช้รอบเวลา/กลไกยกเลิกและส่งใหม่ตามคู่มือระบบรับ
- คุณภาพข้อมูล/Validation แนะนำ:
  - HCODE เป็นหน่วยบริการที่ขึ้นทะเบียน
  - CID ต้องเป็นเลข 13 หลักที่ผ่าน checksum (ถ้ามี)
  - วันที่/เวลา ต้องเป็นค่าวันที่จริง (รองรับปีอธิกสุรทิน)
  - UUC/REFERTYPE/DXTYPE/OPTYPE ใช้ตาม enumerations ที่หน่วยงานกำหนด
- แนวทาง Performance/ขนาดแฟ้ม:
  - แยกไฟล์ตามช่วงวันที่เพื่อควบคุมขนาด
  - บีบอัดก่อนส่ง หากช่องทางรับรองรับ (เช่น zip)
- การจัดการข้อผิดพลาด:
  - หากแฟ้มใดมี error ให้แก้ไขเฉพาะแฟ้มนั้นและส่งซ้ำ โดยคงความสอดคล้องของคีย์อ้างอิงทั้งหมด
  - เก็บ log การส่ง/ใบตอบรับ เพื่อการติดตามสถานะเคลม

---

### 4) ภาคผนวก: คำแนะนำการแมป/ระบบรหัส
- ICD-10 (DIAG): ใช้เวอร์ชันล่าสุด
- ICD-9-CM/OPS (OPER): ใช้มาตรฐานหัตถการที่หน่วยงานกำหนด
- Drug/TMT (DIDSTD): ใช้รหัส TMT ล่าสุด
- รหัสคลินิก/วอร์ด/สัญชาติ/อาชีพ: ใช้ตาม Code Set ที่ประกาศใช้งานล่าสุดของหน่วยงาน

---

### 5) สรุปคีย์ใช้งานทั่วไป (สำหรับนักพัฒนา)
- ระดับบุคคล: (HCODE, PID) และ/หรือ (HCODE, HN), CID
- ระดับ OPD: (HCODE, HN, DATEOPD, SEQ)
- ระดับ IPD: (HCODE, AN)
- การเงิน: CLAIMNO เชื่อม CHT ↔ CHA; ผูกกับ OPD/IPD ผ่าน SEQ/AN ตามชนิดเคส
